<!DOCTYPE html>
<html lang="es" ng-app="myApp" ng-controller="myController">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
        </script>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.0/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>

    <title>ROADMAPS</title>

    <link rel="shortcut icon" type="image/png" href="roadmaps.png" />

    <link rel="stylesheet" type="text/css" href="main.css">
    <link rel="stylesheet" data-ng-if="css" type="text/css" ng-href="{{css}}.css">
</head>

<body>

    <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a href="#" id="title" class="h1 navbar-brand" ng-click="goHome()">ROADMAP</a>
            <div class="navbar-nav ms-auto">                
                <button class="btn float-end" data-bs-toggle="offcanvas" data-bs-target="#offcanvas" role="button">
                    <i class="fa-solid fa-arrows-rotate" data-bs-toggle="offcanvas" data-bs-target="#offcanvas"></i>
                    Open menu
                </button>
            </div>

        </div>
    </nav>

    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvas" data-bs-keyboard="false"
        data-bs-backdrop="false">
        <div class="offcanvas-header">
            <h6 class="offcanvas-title d-none d-sm-block" id="offcanvas">Menu</h6>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body px-0" id="side" ng-bind-html="sidebar | trust" on>
            <!-- side -->
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col min-vh-100 p-4" ng-bind-html="template | trust">
                <!-- template -->
            </div>
        </div>
    </div>

    <script>
        var myModule = angular.module("myApp", []);
        myModule.filter("trust", ['$sce', function ($sce) {
            return function (htmlCode) {
                return $sce.trustAsHtml(htmlCode);
            }
        }]);
        var myController = myModule.controller("myController", ["$scope", "$http",
            function ($scope, $http) {
                $scope.template = "";
                $scope.sidebar = "";
                $scope.css = "light_one";
                $scope.loadcss = function (st) {
                    $scope.css = st;
                }
                $scope.loadsidebar = function () {
                    $http.get("index.md").then(function (response) {
                        const converter = new showdown.Converter();
                        $scope.sidebar = converter.makeHtml(response.data);
                    });
                }
                $scope.loadtemplate = function (tpl) {
                    $http.get(tpl + ".md").then(function (response) {
                        const converter = new showdown.Converter();
                        $scope.template = converter.makeHtml(response.data);
                    });
                }
                $('#side').on('click', 'a', function () {
                    var namefile = this.href.substring(this.href.lastIndexOf('/') + 1);
                    $http.get(namefile).then(function (response) {
                        const converter = new showdown.Converter();
                        $scope.template = converter.makeHtml(response.data);
                    });
                    return false;
                });
                $scope.loadsidebar();
                $scope.loadtemplate("welcome");
                $scope.goHome = function () {
                    $scope.loadtemplate("welcome");
                }
                $scope.goMenu = function () {
                    $scope.loadtemplate("index");
                }
                $scope.layoutOne = function () {
                    $scope.loadcss("one");
                }
            },
        ]);
    </script>

    </div>
</body>

</html>
